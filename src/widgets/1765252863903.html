<!DOCTYPE html>
<html lang="en" style="margin:0;padding:0;height:100%;overflow:hidden;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Monitor (Imported)</title>
    <style>
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: transparent;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        #widget-root {
            width: 100%;
            height: 100%;
            opacity: 0.95;
        }
        
        .system-monitor {
    background: linear-gradient(135deg, #2d3748, #1a202c);
    border-radius: 15px;
    padding: 20px;
    color: white;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    min-width: 280px;
}

.monitor-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    font-weight: bold;
    font-size: 16px;
}

.refresh-btn {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    cursor: pointer;
    font-size: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
}

.refresh-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

.monitor-item {
    margin-bottom: 20px;
}

.monitor-label {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    font-weight: 600;
    font-size: 14px;
}

.monitor-bar {
    width: 100%;
    height: 12px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    overflow: hidden;
    margin-bottom: 6px;
}

.monitor-fill {
    height: 100%;
    background: linear-gradient(90deg, #4ecdc4, #44a08d);
    width: 0%;
    transition: width 0.5s ease, background 0.3s ease;
    border-radius: 6px;
}

.monitor-value {
    text-align: right;
    font-size: 14px;
    font-weight: bold;
    margin-bottom: 4px;
}

.monitor-info {
    text-align: right;
    font-size: 11px;
    color: rgba(255, 255, 255, 0.7);
}

/* Color variations based on usage */
.monitor-fill.warning {
    background: linear-gradient(90deg, #f7b731, #f5af19);
}

.monitor-fill.danger {
    background: linear-gradient(90deg, #ff6b6b, #ee5a24);
}
    </style>
</head>
<body>
    <div id="widget-root"><div class="system-monitor">
    <div class="monitor-header">
        <span>üñ•Ô∏è System Monitor</span>
        <button onclick="refreshSystem()" class="refresh-btn">üîÑ</button>
    </div>
    
    <div class="monitor-item">
        <div class="monitor-label">
            <span>CPU</span>
            <span id="cpu-temp" style="display: none; font-size: 10px; color: #4ecdc4;">--¬∞C</span>
        </div>
        <div class="monitor-bar">
            <div class="monitor-fill" id="cpu-bar"></div>
        </div>
        <div class="monitor-value" id="cpu-usage">0%</div>
    </div>
    
    <div class="monitor-item">
        <div class="monitor-label">Memory</div>
        <div class="monitor-bar">
            <div class="monitor-fill" id="memory-bar"></div>
        </div>
        <div class="monitor-value" id="memory-usage">0%</div>
        <div class="monitor-info" id="memory-info">0 B / 0 B</div>
    </div>
    
    <div class="monitor-item">
        <div class="monitor-label">Disk</div>
        <div class="monitor-bar">
            <div class="monitor-fill" id="disk-bar"></div>
        </div>
        <div class="monitor-value" id="disk-usage">0%</div>
        <div class="monitor-info" id="disk-info">0 B / 0 B</div>
    </div>
</div></div>
    <script>
        try { // System Monitor Widget with real system data
let systemInterval;

// Format bytes to human readable format
function formatBytes(bytes) {
    if (bytes === 0) return '0 B';
    const k = 1024;
    const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

// Update system display with real data
function updateSystemDisplay(data) {
    // Update CPU
    document.getElementById('cpu-usage').textContent = Math.round(data.cpuUsage) + '%';
    document.getElementById('cpu-bar').style.width = data.cpuUsage + '%';
    
    // Update CPU color based on usage
    const cpuBar = document.getElementById('cpu-bar');
    if (data.cpuUsage < 50) {
        cpuBar.style.background = 'linear-gradient(90deg, #4ecdc4, #44a08d)';
    } else if (data.cpuUsage < 80) {
        cpuBar.style.background = 'linear-gradient(90deg, #f7b731, #f5af19)';
    } else {
        cpuBar.style.background = 'linear-gradient(90deg, #ff6b6b, #ee5a24)';
    }
    
    // Update Memory
    document.getElementById('memory-usage').textContent = Math.round(data.memoryUsage) + '%';
    document.getElementById('memory-bar').style.width = data.memoryUsage + '%';
    document.getElementById('memory-info').textContent = 
        formatBytes(data.memoryUsed) + ' / ' + formatBytes(data.memoryTotal);
    
    // Update Memory color based on usage
    const memoryBar = document.getElementById('memory-bar');
    if (data.memoryUsage < 50) {
        memoryBar.style.background = 'linear-gradient(90deg, #4ecdc4, #44a08d)';
    } else if (data.memoryUsage < 80) {
        memoryBar.style.background = 'linear-gradient(90deg, #f7b731, #f5af19)';
    } else {
        memoryBar.style.background = 'linear-gradient(90deg, #ff6b6b, #ee5a24)';
    }
    
    // Update Disk
    document.getElementById('disk-usage').textContent = Math.round(data.diskUsage) + '%';
    document.getElementById('disk-bar').style.width = data.diskUsage + '%';
    document.getElementById('disk-info').textContent = 
        formatBytes(data.diskUsed) + ' / ' + formatBytes(data.diskTotal);
    
    // Update Disk color based on usage
    const diskBar = document.getElementById('disk-bar');
    if (data.diskUsage < 50) {
        diskBar.style.background = 'linear-gradient(90deg, #4ecdc4, #44a08d)';
    } else if (data.diskUsage < 80) {
        diskBar.style.background = 'linear-gradient(90deg, #f7b731, #f5af19)';
    } else {
        diskBar.style.background = 'linear-gradient(90deg, #ff6b6b, #ee5a24)';
    }
    
    // Update CPU Temperature if available
    if (data.cpuTemperature !== null && data.cpuTemperature !== undefined) {
        document.getElementById('cpu-temp').textContent = Math.round(data.cpuTemperature) + '¬∞C';
        document.getElementById('cpu-temp').style.display = 'block';
        
        // Color based on temperature
        const tempElement = document.getElementById('cpu-temp');
        if (data.cpuTemperature < 60) {
            tempElement.style.color = '#4ecdc4';
        } else if (data.cpuTemperature < 80) {
            tempElement.style.color = '#f7b731';
        } else {
            tempElement.style.color = '#ff6b6b';
        }
    } else {
        document.getElementById('cpu-temp').style.display = 'none';
    }
}

// Show error when system data is unavailable
function showSystemError() {
    document.getElementById('cpu-usage').textContent = '--%';
    document.getElementById('memory-usage').textContent = '--%';
    document.getElementById('disk-usage').textContent = '--%';
    document.getElementById('memory-info').textContent = 'Data unavailable';
    document.getElementById('disk-info').textContent = 'Data unavailable';
    document.getElementById('cpu-temp').style.display = 'none';
    
    // Set error colors
    document.getElementById('cpu-bar').style.background = '#666';
    document.getElementById('memory-bar').style.background = '#666';
    document.getElementById('disk-bar').style.background = '#666';
}

// Fetch real system data from Tauri backend
async function fetchSystemData() {
    try {
        // Check if Tauri API is available
        if (typeof window.__TAURI__ === 'undefined') {
            // Fallback to mock data for development
            updateSystemDisplay({
                cpuUsage: Math.random() * 100,
                memoryUsage: Math.random() * 100,
                memoryTotal: 16777216000,
                memoryUsed: Math.random() * 16777216000,
                diskUsage: Math.random() * 100,
                diskTotal: 500000000000,
                diskUsed: Math.random() * 500000000000,
                cpuTemperature: 45 + Math.random() * 30
            });
            return;
        }
        
        const { invoke } = window.__TAURI__.core;
        const systemData = await invoke('get_system_info');
        updateSystemDisplay(systemData);
    } catch (error) {
        console.error('Failed to fetch system data:', error);
        showSystemError();
    }
}

function refreshSystem() {
    fetchSystemData();
}

// Initialize system monitor
function initSystemMonitor() {
    fetchSystemData();
    // Update every 2 seconds
    systemInterval = setInterval(fetchSystemData, 2000);
}

// Start the system monitor
initSystemMonitor(); } catch(e) { console.error('Widget error:', e); }
    </script>
</body>
</html>